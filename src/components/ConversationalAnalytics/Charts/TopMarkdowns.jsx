import React from 'react';
import './dashboard-layout.css';
import { isEmptyObject } from '../../common/strings';
import { NoContent } from '@supportninja/ui-components';

export default function TopMarkdowns({ metricsData }) {
    // Safely extract and normalize metric data, checking for various key casing
    const raw = metricsData?.top_markdowns || {};
    const top = {
        People: raw?.People ?? raw?.people ?? 0,
        Process: raw?.Process ?? raw?.process ?? 0,
        Policy: raw?.Policy ?? raw?.policy ?? raw?.Policies ?? raw?.policies ?? 0,
        Place: raw?.Place ?? raw?.place ?? raw?.Places ?? raw?.places ?? 0,
    };

    // Card configuration (unchanged)
    const markdowns = [
        {
            key: 'people',
            title: `People: ${top.People}`,
            text: 'N/A',
            image: (
                <svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 21 21" fill="none">
                    <path d="M10.5 0C8.4233 0 6.39323 0.615814 4.66652 1.76957C2.9398 2.92332 1.59399 4.5632 0.79927 6.48182C0.00454967 8.40045 -0.203386 10.5116 0.201759 12.5484C0.606904 14.5852 1.60693 16.4562 3.07538 17.9246C4.54383 19.3931 6.41475 20.3931 8.45155 20.7982C10.4884 21.2034 12.5996 20.9954 14.5182 20.2007C16.4368 19.406 18.0767 18.0602 19.2304 16.3335C20.3842 14.6068 21 12.5767 21 10.5C21 9.12112 20.7284 7.75574 20.2007 6.48182C19.6731 5.2079 18.8996 4.05039 17.9246 3.07538C16.9496 2.10036 15.7921 1.32694 14.5182 0.799265C13.2443 0.271591 11.8789 0 10.5 0ZM15.0731 6.63205C15.3985 6.63205 15.7166 6.72855 15.9872 6.90934C16.2578 7.09014 16.4687 7.34711 16.5932 7.64776C16.7178 7.94841 16.7503 8.27924 16.6869 8.59841C16.6234 8.91758 16.4667 9.21076 16.2366 9.44086C16.0065 9.67097 15.7133 9.82768 15.3941 9.89117C15.0749 9.95465 14.7441 9.92207 14.4435 9.79753C14.1428 9.673 13.8858 9.46211 13.705 9.19153C13.5242 8.92095 13.4277 8.60284 13.4277 8.27741C13.4285 7.84128 13.6021 7.42323 13.9105 7.11483C14.2189 6.80644 14.637 6.63283 15.0731 6.63205ZM10.5 4.63261C10.9572 4.63261 11.4042 4.7682 11.7844 5.02223C12.1646 5.27626 12.4609 5.63732 12.6359 6.05975C12.8108 6.48219 12.8566 6.94702 12.7674 7.39548C12.6782 7.84393 12.458 8.25586 12.1347 8.57918C11.8114 8.9025 11.3995 9.12268 10.951 9.21188C10.5026 9.30108 10.0377 9.2553 9.6153 9.08032C9.19286 8.90535 8.8318 8.60903 8.57778 8.22885C8.32375 7.84867 8.18816 7.4017 8.18816 6.94446C8.18816 6.33132 8.43173 5.74329 8.86528 5.30974C9.29884 4.87618 9.88686 4.63261 10.5 4.63261ZM5.91797 6.63205C6.24339 6.63205 6.56151 6.72855 6.83209 6.90934C7.10266 7.09014 7.31356 7.34711 7.43809 7.64776C7.56262 7.94841 7.59521 8.27924 7.53172 8.59841C7.46823 8.91758 7.31153 9.21076 7.08142 9.44086C6.85131 9.67097 6.55813 9.82768 6.23896 9.89117C5.91979 9.95465 5.58897 9.92207 5.28831 9.79753C4.98766 9.673 4.73069 9.46211 4.5499 9.19153C4.3691 8.92095 4.2726 8.60284 4.2726 8.27741C4.27339 7.84128 4.44699 7.42323 4.75539 7.11483C5.06378 6.80644 5.48183 6.63283 5.91797 6.63205ZM3.76977 14.5078C3.45412 14.5078 3.15141 14.3824 2.92821 14.1592C2.70502 13.936 2.57963 13.6333 2.57963 13.3177C2.57963 13.0029 2.64168 12.6912 2.76223 12.4004C2.88279 12.1096 3.05948 11.8454 3.28221 11.623C3.50493 11.4005 3.76932 11.2242 4.06026 11.104C4.3512 10.9838 4.66297 10.9221 4.97776 10.9225H6.86413C7.03722 10.9232 7.20975 10.9421 7.37886 10.979C6.89654 11.2918 6.50012 11.7202 6.22573 12.2253C5.95134 12.7305 5.8077 13.2962 5.80788 13.8711C5.80917 14.0906 5.84947 14.3083 5.9269 14.5137L3.76977 14.5078ZM13.2611 15.4004H7.72103C7.31306 15.4004 6.9218 15.2383 6.63332 14.9498C6.34484 14.6614 6.18278 14.2701 6.18278 13.8621C6.18356 13.0428 6.50961 12.2572 7.08927 11.6781C7.66893 11.099 8.45479 10.7737 9.27416 10.7737H11.708C12.5279 10.7737 13.3142 11.0994 13.8939 11.6792C14.4737 12.2589 14.7994 13.0452 14.7994 13.8651C14.7998 14.0672 14.7603 14.2674 14.6831 14.4542C14.6059 14.641 14.4926 14.8108 14.3497 14.9537C14.2068 15.0966 14.0371 15.2099 13.8503 15.2871C13.6634 15.3642 13.4632 15.4038 13.2611 15.4034V15.4004ZM17.2213 14.5078H15.0672C15.1446 14.3023 15.1849 14.0847 15.1862 13.8651C15.1864 13.2903 15.0427 12.7245 14.7683 12.2194C14.4939 11.7143 14.0975 11.2858 13.6152 10.9731C13.7843 10.9362 13.9568 10.9172 14.1299 10.9165H16.0163C16.3311 10.9162 16.6429 10.9778 16.9338 11.098C17.2247 11.2182 17.4891 11.3946 17.7118 11.617C17.9346 11.8395 18.1113 12.1036 18.2318 12.3944C18.3524 12.6852 18.4144 12.9969 18.4144 13.3117C18.4152 13.4687 18.3849 13.6244 18.3253 13.7697C18.2656 13.9149 18.1778 14.047 18.0669 14.1582C17.956 14.2693 17.8242 14.3575 17.6791 14.4175C17.5339 14.4775 17.3784 14.5082 17.2213 14.5078Z" fill="#2388FF" />
                </svg>
            ),
        },
        {
            key: 'processes',
            title: `Process: ${top.Process}`,
            text: 'N/A',
            image: (
                <svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 21 21" fill="none">
                    <circle cx="10.5" cy="10.5" r="10.5" fill="#F2B203" />
                    <path d="M13.4763 9.75692H12.8619C12.813 9.58081 12.7452 9.4099 12.6608 9.24786L13.0964 8.81228C13.1454 8.7633 13.1725 8.69869 13.1725 8.62939C13.1725 8.56009 13.1454 8.49548 13.0969 8.4465L12.3925 7.74206C12.2914 7.6415 12.1278 7.6415 12.0267 7.74206L11.6041 8.16463C11.441 8.07449 11.2686 8.00154 11.0899 7.94788V7.34242C11.0899 7.19966 10.9737 7.08398 10.8309 7.08398H9.83518C9.69242 7.08398 9.57675 7.20018 9.57675 7.34242V7.94788C9.40115 8.0005 9.23076 8.07189 9.06977 8.16047L8.63156 7.72227C8.58258 7.67329 8.51745 7.64619 8.44867 7.64619C8.37937 7.64619 8.31477 7.67329 8.26579 7.72227L7.56186 8.42671C7.51288 8.47569 7.48631 8.5403 7.48631 8.6096C7.48631 8.67889 7.5134 8.7435 7.56186 8.79248L8.00996 9.24058C7.92764 9.39638 7.86146 9.5605 7.81248 9.72932H7.16274C7.01997 9.72932 6.9043 9.84552 6.9043 9.98776V10.9835C6.9043 11.1262 7.02049 11.2419 7.16274 11.2419H7.82655C7.87657 11.4024 7.94223 11.5587 8.02247 11.7072L7.5431 12.1866C7.49413 12.2355 7.46703 12.3001 7.46703 12.3694C7.46703 12.4387 7.49413 12.5034 7.54258 12.5523L8.24703 13.2568C8.29601 13.3058 8.36062 13.3328 8.42992 13.3328C8.49922 13.3328 8.56383 13.3058 8.61281 13.2568L9.09374 12.7764C9.2391 12.8545 9.3923 12.9191 9.54965 12.9681V13.6564C9.54965 13.7992 9.66585 13.9149 9.80861 13.9149H10.8043C10.9471 13.9149 11.0628 13.7987 11.0628 13.6564V12.9843C11.2238 12.9379 11.3806 12.8759 11.5301 12.7988L12.0074 13.2761C12.0564 13.325 12.1215 13.3516 12.1903 13.3516C12.2596 13.3516 12.3242 13.3245 12.3732 13.2761L13.0771 12.5721C13.1261 12.5232 13.1532 12.4585 13.1532 12.3892C13.1532 12.3199 13.1261 12.2553 13.0776 12.2064L12.6217 11.7504C12.7077 11.5978 12.7786 11.4362 12.8322 11.27H13.4773C13.62 11.27 13.7357 11.1538 13.7357 11.0116V10.0159C13.7357 9.87313 13.6195 9.75745 13.4773 9.75745L13.4763 9.75692ZM11.6771 10.4999C11.6771 11.2487 11.068 11.8583 10.3187 11.8583C9.56996 11.8583 8.96081 11.2492 8.96081 10.4999C8.96081 9.75119 9.56992 9.14205 10.3187 9.14205C11.0675 9.14205 11.6771 9.75115 11.6771 10.4999Z" fill="white" />
                    <path d="M10.0219 5.95879L11.1953 5.00476L10.0766 4.00488C6.60385 4.13306 3.81885 6.99781 3.81885 10.5007C3.81885 10.5392 3.81937 10.5778 3.81989 10.6164L4.78539 9.53623C4.80519 9.51435 4.83333 9.50236 4.8625 9.50288C4.89168 9.5034 4.9193 9.51695 4.93806 9.53988L5.76861 10.5611C5.76809 10.5408 5.76809 10.521 5.76809 10.5007C5.76809 8.09091 7.65059 6.11252 10.0225 5.95872L10.0219 5.95879Z" fill="white" />
                    <path d="M10.3719 4L11.4161 4.93319C11.438 4.95299 11.45 4.98112 11.4494 5.0103C11.4489 5.03948 11.4354 5.06709 11.4124 5.08585L10.3511 5.94922C12.6875 5.96538 14.6116 7.75101 14.8466 10.0301L15.796 11.1977L16.8052 10.0686C16.5833 6.70167 13.7868 4.02708 10.3719 4Z" fill="white" />
                    <path d="M16.8177 10.3535L15.8668 11.4175C15.8475 11.4389 15.8204 11.4508 15.7923 11.4508H15.7897C15.7605 11.4503 15.7329 11.4368 15.7142 11.4138L14.8685 10.3738C14.8695 10.4155 14.8701 10.4572 14.8701 10.4994C14.8701 12.8102 13.1387 14.7246 10.9054 15.0132L9.75439 15.949L10.9007 16.9739C14.2135 16.6785 16.8187 13.8872 16.8187 10.4994C16.8187 10.451 16.8182 10.4025 16.8171 10.3541L16.8177 10.3535Z" fill="white" />
                    <path d="M9.50047 15.9442C9.50099 15.9151 9.51454 15.8874 9.53746 15.8687L10.5493 15.046C10.4733 15.0496 10.3967 15.0517 10.3195 15.0517C7.94404 15.0517 5.98804 13.2228 5.78543 10.899L4.85693 9.75684L3.83203 10.9037C4.04149 14.3003 6.87127 17.0004 10.3201 17.0004C10.4217 17.0004 10.5223 16.9978 10.6229 16.9931L9.53493 16.0208C9.51304 16.001 9.50106 15.9729 9.50158 15.9437L9.50047 15.9442Z" fill="white" />
                </svg>
            ),
        },
        {
            key: 'places',
            title: `Place: ${top.Place}`,
            text: 'N/A',
            image: (
                <svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 21 21" fill="none">
                    <path d="M10.491 0C4.68983 0 0 4.69018 0 10.4912C0 16.2922 4.68983 21 10.491 21C16.2921 21 21 16.2922 21 10.4912C21 4.69018 16.2921 0 10.491 0ZM10.5 3.55708V3.55752C12.8998 3.55752 14.8453 5.40889 14.8453 7.69273C14.8438 8.34536 14.6841 8.98832 14.3714 9.56917C14.2905 9.7186 14.1918 9.91104 14.0924 10.05L10.519 15.7327L6.87496 10.0099C6.77267 9.86852 6.71178 9.72231 6.62872 9.56994L6.62742 9.56822C6.31653 8.98709 6.15476 8.34388 6.15476 7.69178C6.15481 5.40796 8.10016 3.55708 10.5 3.55708ZM10.5 5.29146C9.8922 5.29152 9.30931 5.53299 8.87952 5.96276C8.44974 6.39253 8.20826 6.97542 8.20821 7.58321C8.20826 8.191 8.44974 8.77388 8.87952 9.20366C9.30931 9.63343 9.8922 9.8749 10.5 9.87496C11.1078 9.8749 11.6907 9.63343 12.1205 9.20366C12.5503 8.77388 12.7917 8.191 12.7918 7.58321C12.7917 6.97542 12.5503 6.39253 12.1205 5.96276C11.6907 5.53299 11.1078 5.29152 10.5 5.29146ZM10.5 15.959C11.607 15.959 12.6687 16.0371 13.4515 16.1762C14.2343 16.3153 14.6742 16.504 14.6743 16.7007C14.6746 16.7981 14.5668 16.8946 14.3571 16.9846C14.1475 17.0747 13.84 17.1565 13.4524 17.2254C13.0648 17.2943 12.6045 17.349 12.0979 17.3863C11.5913 17.4236 11.0484 17.4428 10.5 17.4428C9.95165 17.4428 9.40867 17.4236 8.90209 17.3863C8.39551 17.349 7.93526 17.2943 7.54761 17.2254C7.15997 17.1565 6.85254 17.0747 6.64288 16.9846C6.43322 16.8946 6.32544 16.7981 6.3257 16.7007C6.32584 16.504 6.76568 16.3153 7.54849 16.1762C8.3313 16.0371 9.39298 15.959 10.5 15.959Z" fill="#4AB58E" />
                </svg>
            ),
        },
        {
            key: 'policies',
            title: `Policy: ${top.Policy}`,
            text: 'N/A',
            image: (
                <svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 21 21" fill="none">
                    <circle cx="10.5" cy="10.5" r="10.5" fill="#AF6145" />
                    <path d="M9.98841 11.1957V6H10.5943V9.27289C10.5943 9.39469 10.6944 9.49463 10.8187 9.49463C10.942 9.49463 11.0432 9.39573 11.0432 9.27289V6H11.6491V11.1957H9.98841Z" fill="#FFE5C9" />
                    <path d="M4.81885 6.41433C4.81885 6.18634 5.00642 6 5.23824 6H9.53865V11.4174C9.53865 11.5392 9.63876 11.6392 9.7631 11.6392H11.8737C11.997 11.6392 12.0982 11.5403 12.0982 11.4174V6H16.3984C16.6302 6 16.8188 6.18531 16.8188 6.41433V15.5857C16.8188 15.8137 16.6302 16 16.3984 16H5.23824C5.00747 16 4.81885 15.8147 4.81885 15.5857V6.41433Z" fill="#FFE5C9" />
                </svg>
            ),
        },
    ];

    const isEmpty = isEmptyObject(metricsData?.top_markdowns);

    return (
        <section
            className="panel !mr-0 pr-0 w-full !shadow-md"
            aria-labelledby="top-markdowns-title"
            role="region"
        >
            {isEmpty ? (
                <NoContent className="!w-full" />
            ) : (
                <>

                    <div
                        className="
                            grid w-full min-w-0
                            gap-2 sm:gap-3
                            [grid-auto-rows:1fr]
                        "
                        /* Responsive auto-fit grid: single column on very narrow screens, fills more columns as space allows */
                        style={{ gridTemplateColumns: 'repeat(auto-fit, minmax(min(220px, 100%), 1fr))' }}
                    >
                        {markdowns.map((m) => (
                            <article
                                key={m.key}
                                className={`
                                     relative !shadow-lg markdown-card--${m.key}
                                    w-full min-w-0 overflow-hidden box-border
                      
                                    rounded-lg sm:rounded-xl
                                    p-3 sm:p-4 md:p-5
                                    bg-white
                                    transition
                                    hover:shadow-xl
                                `}
                            >
                                <div className="absolute top-3 right-3 sm:top-3 sm:right-3 md:top-3 md:right-3">
                                    {m.image}
                                </div>
                                <div className="markdown-card__title text-slate-800 text-sm sm:text-[15px] md:text-base font-semibold leading-6 sm:leading-7">
                                    {m.title}
                                </div>
                                {/* Optional secondary text (kept for future use) */}
                                {/* <p className="mt-1 text-xs sm:text-[13px] text-slate-500">{m.text}</p> */}
                            </article>
                        ))}
                    </div>
                </>
            )}
        </section>
    );
}